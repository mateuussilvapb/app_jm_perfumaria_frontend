<ng-container *ngIf="data.length > 0; else noData">
  <p-table
    #dt1
    [rows]="10"
    dataKey="id"
    [value]="data"
    [paginator]="true"
    class="table-custom custom-search-field"
    stateStorage="session"
    [rowsPerPageOptions]="[5, 10, 20]"
    [tableStyle]="{ 'min-width': '60rem' }"
    [globalFilterFields]="globalFilterFieldsTable"
  >
    <ng-template pTemplate="caption" class="p-0">
      <div class="flex">
        <p-iconfield iconPosition="left" class="ml-auto">
          <p-inputicon>
            <i class="pi pi-search"></i>
          </p-inputicon>
          <input
            pInputText
            type="text"
            placeholder="Informe um filtro..."
            (input)="onGlobalFilter(dt1, $event)"
            [value]="$any(dt1).filters['global']?.value"
          />
        </p-iconfield>
      </div>
    </ng-template>
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="nome" class="text-center" id="th-nome-produto">
          <div class="flex items-center gap-2">
            Nome
            <p-sortIcon field="nome" />
          </div>
        </th>
        <th pSortableColumn="descricao" class="text-center" id="th-descricao-produto">
          <div class="flex items-center gap-2">
            Descrição
            <p-sortIcon field="descricao" />
          </div>
        </th>
        <th pSortableColumn="precoCusto" class="text-center" id="th-custo-produto">
          <div class="flex items-center gap-2">
            Custo (R$)
            <p-sortIcon field="precoCusto" />
          </div>
        </th>
        <th pSortableColumn="precoVenda" class="text-center" id="th-venda-produto">
          <div class="flex items-center gap-2">
            Venda (R$)
            <p-sortIcon field="precoVenda" />
          </div>
        </th>
        <th pSortableColumn="status" class="text-center" id="th-status-produto">
          <div class="flex items-center gap-2">
            Status
            <p-sortIcon field="status" />
          </div>
        </th>
        <th pSortableColumn="codigo" class="text-center" id="th-codigo-produto">
          <div class="flex items-center gap-2">
            Código
            <p-sortIcon field="codigo" />
          </div>
        </th>
        <th pSortableColumn="quantidadeEmEstoque" class="text-center" id="th-estoque-produto">
          <div class="flex items-center gap-2">
            Em Estoque
            <p-sortIcon field="quantidadeEmEstoque" />
          </div>
        </th>
        <th pSortableColumn="marca.nome" class="text-center" id="th-marca-produto">
          <div class="flex items-center gap-2">
            Marca
            <p-sortIcon field="marca.nome" />
          </div>
        </th>
        <th pSortableColumn="categoria.nome" class="text-center" id="th-categoria-produto">
          <div class="flex items-center gap-2">
            Categoria
            <p-sortIcon field="categoria.nome" />
          </div>
        </th>
        <th class="text-center" id="th-acoes-produto">Opções</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-produto>
      <tr>
        <!-- Frozen Nome -->
        <td pFrozenColumn class="text-center" style="min-width: 6rem">
          {{ produto.nome || "–" }}
        </td>
        <!-- Descrição -->
        <td class="text-center" style="min-width: 8rem">
          {{ produto.descricao || "–" }}
        </td>
        <!-- Preço de Custo -->
        <td class="text-center">
          {{ produto.precoCusto | currency: 'BRL' }}
        </td>
        <!-- Preço de Venda -->
        <td class="text-center">
          {{ produto.precoVenda | currency: 'BRL'  }}
        </td>
        <!-- Status Tag -->
        <td class="text-center">
          <p-tag
            [severity]="
              produto.status === STATUS.ATIVO ? 'success' : 'danger'
            "
            [value]="getStatusNormalized(produto.status)"
          ></p-tag>
        </td>
        <!-- Código -->
        <td class="text-center">
          {{ produto.codigo }}
        </td>
        <!-- Quantidade em Estoque -->
        <td class="text-center">
          {{ produto.quantidadeEmEstoque }}
        </td>
        <!-- Marca Nome -->
        <td class="text-center">
          {{ produto.marca?.nome || "–" }}
        </td>
        <!-- Categoria Nome -->
        <td class="text-center">
          {{ produto.categoria?.nome || "–" }}
        </td>
        <!-- Opções -->
        <td class="text-center" style="min-width: 4rem">
          <p-button
            icon="pi pi-ellipsis-v"
            [text]="true"
            styleClass="text-color"
            (onClick)="onToggleMenu($event, produto)"
          ></p-button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</ng-container>

<ng-template #noData>
  <sem-dados [data]="data"></sem-dados>
</ng-template>

<p-menu #actionMenu [popup]="true"></p-menu>
