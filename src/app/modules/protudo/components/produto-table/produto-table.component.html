<p-card>
  <ng-container *ngIf="data.length > 0; else noData">
    <p-table
      [value]="data"
      [paginator]="true"
      [rows]="10"
      [rowsPerPageOptions]="[5, 10, 20]"
      class="table-custom p-datatable-gridlines"
      [tableStyle]="{ 'min-width': '60rem' }"
    >
      <ng-template pTemplate="header">
        <tr>
          <th pFrozenColumn class="text-center">Nome</th>
          <th class="text-center">Descrição</th>
          <th class="text-center">Custo (R$)</th>
          <th class="text-center">Venda (R$)</th>
          <th class="text-center">Status</th>
          <th class="text-center">Situação</th>
          <th class="text-center">Código</th>
          <th class="text-center">Em Estoque</th>
          <th class="text-center">Marca</th>
          <th class="text-center">Categoria</th>
          <th class="text-center">Criado Em</th>
          <th class="text-center">Opções</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-produto>
        <tr>
          <!-- Frozen Nome -->
          <td pFrozenColumn class="text-center" style="min-width: 6rem">
            {{ produto.nome || '–' }}
          </td>
          <!-- Descrição -->
          <td class="text-center" style="min-width: 8rem">
            {{ produto.descricao || '–' }}
          </td>
          <!-- Preço de Custo -->
          <td class="text-center">
            {{ produto.precoCusto | number:'1.2-2' }}
          </td>
          <!-- Preço de Venda -->
          <td class="text-center">
            {{ produto.precoVenda | number:'1.2-2' }}
          </td>
          <!-- Status Tag -->
          <td class="text-center">
            <p-tag
              [severity]="produto.status === STATUS.ATIVO ? 'success' : 'danger'"
              [value]="getStatusNormalized(produto.status)"
            ></p-tag>
          </td>
          <!-- Situação Tag -->
          <td class="text-center">
            <p-tag
              [severity]="produto.situacao === 'CADASTRO_FINALIZADO' ? 'success' : 'warning'"
              [value]="produto.situacao.replace('_', ' ')"
            ></p-tag>
          </td>
          <!-- Código -->
          <td class="text-center">
            {{ produto.codigo }}
          </td>
          <!-- Quantidade em Estoque -->
          <td class="text-center">
            {{ produto.quantidadeEmEstoque }}
          </td>
          <!-- Marca Nome -->
          <td class="text-center">
            {{ produto.marca?.nome || '–' }}
          </td>
          <!-- Categoria Nome -->
          <td class="text-center">
            {{ produto.categoria?.nome || '–' }}
          </td>
          <!-- CreatedAt -->
          <td class="text-center">
            {{ produto.createdAt | date:'dd/MM/yyyy HH:mm' }}
          </td>
          <!-- Opções -->
          <td class="text-center" style="min-width: 4rem">
            <p-button
              icon="pi pi-ellipsis-v"
              [text]="true"
              styleClass="text-color"
              (onClick)="onToggleMenu($event, produto)"
            ></p-button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </ng-container>

  <ng-template #noData>
    <sem-dados [data]="data"></sem-dados>
  </ng-template>
</p-card>

<p-menu #actionMenu [popup]="true"></p-menu>