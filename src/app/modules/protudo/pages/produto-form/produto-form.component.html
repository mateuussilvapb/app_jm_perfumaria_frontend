<form [formGroup]="form" (ngSubmit)="onSubmit($event)" novalidate>
  <p-card [header]="titleCard">
    <!-- CAMPOS PRINCIPAIS -->
    <div class="grid mt-2">
      <!-- Nome -->
      <div class="col-12 lg:col-6">
        <label for="nome-produto">Nome</label>
        <input
          pInputText
          type="text"
          maxlength="100"
          class="w-full mt-1"
          id="nome-produto"
          formControlName="nome"
          placeholder="Informe o nome..."
        />
        <app-form-control-errors [control]="getControlForm('nome')"></app-form-control-errors>
      </div>

      <!-- Preço de Custo -->
      <div class="col-12 lg:col-3">
        <label for="preco-custo">Preço de Custo</label>
        <input
          pInputText
          type="number"
          step="0.01"
          class="w-full mt-1"
          id="preco-custo"
          formControlName="precoCusto"
          placeholder="R$"
        />
        <app-form-control-errors [control]="getControlForm('precoCusto')"></app-form-control-errors>
      </div>

      <!-- Preço de Venda -->
      <div class="col-12 lg:col-3">
        <label for="preco-venda">Preço de Venda</label>
        <input
          pInputText
          type="number"
          step="0.01"
          class="w-full mt-1"
          id="preco-venda"
          formControlName="precoVenda"
          placeholder="R$"
        />
        <app-form-control-errors [control]="getControlForm('precoVenda')"></app-form-control-errors>
      </div>

      <!-- Status -->
      <div class="col-12 lg:col-3">
        <label for="status-produto">Status</label>
        @if (!isView) {
          <p-select
            id="status-produto"
            class="w-full mt-1"
            formControlName="status"
            [options]="statusOptions"
            optionLabel="label"
            optionValue="value"
            placeholder="Selecione o status"
          ></p-select>
        } @else {
          <input
            pInputText
            class="w-full mt-1"
            [value]="getStatusLabel(responseProduto?.status)"
            readonly
          />
        }
      </div>

      <!-- Marca -->
      <div class="col-12 lg:col-4">
      <label for="marca-produto">Marca</label>
        <p-select
          id="marca-produto"
          formControlName="idMarca"
          [options]="marcaOptions"
          optionLabel="label"
          optionValue="value"
          [showClear]="true"
          [placeholder]="isView || isEditable ? '' : 'Selecione a marca'"
          [filter]="true"
          filterPlaceholder="Busca..."
          class="w-full mt-1"
        ></p-select>
        <app-form-control-errors [control]="getControlForm('idMarca')"></app-form-control-errors>
      </div>

      <!-- Categoria -->
      <div class="col-12 lg:col-5">
      <label for="categoria-produto">Categoria</label>
        <p-select
          id="categoria-produto"
          formControlName="idCategoria"
          [options]="categoriaOptions"
          optionLabel="label"
          [showClear]="true"
          optionValue="value"
          [placeholder]="isView || isEditable ? '' : 'Selecione a categoria'"
          [filter]="true"
          filterPlaceholder="Busca..."
          class="w-full mt-1"
        ></p-select>
        <app-form-control-errors [control]="getControlForm('idCategoria')"></app-form-control-errors>
      </div>

      <!-- Descrição -->
      <div class="col-12">
        <label for="descricao-produto">Descrição</label>
        <textarea
          [rows]="5"
          [cols]="30"
          pInputTextarea
          class="w-full mt-1"
          [autoResize]="true"
          id="descricao-produto"
          formControlName="descricao"
        ></textarea>
        <app-form-control-errors [control]="getControlForm('descricao')"></app-form-control-errors>
      </div>
    </div>

    <!-- INFORMAÇÕES RELACIONADAS -->
    @if (isView) {
      <div class="grid mt-3">
        <!-- Marca -->
        <div class="col-12 md:col-6">
          <label>Marca</label>
          <input pInputText class="w-full" [value]="responseProduto?.marca?.nome" readonly />
        </div>
        <!-- Categoria -->
        <div class="col-12 md:col-6">
          <label>Categoria</label>
          <input pInputText class="w-full" [value]="responseProduto?.categoria?.nome" readonly />
        </div>
      </div>
    }

    <!-- INFORMAÇÕES COMPLEMENTARES -->
    @if (isView) {
      <div class="flex flex-row justify-content-between mt-3">
        <small><strong>Usuário: </strong> {{ responseProduto.createdBy }}</small>
        <small><strong>Data: </strong> {{ responseProduto.createdAt | date: 'dd/MM/yyyy HH:mm' }}</small>
      </div>
    }

    <!-- BOTÕES -->
    <div
      class="pt-3 flex flex-row flex-wrap items-center justify-content-between"
    >
      <!-- botão Voltar -->
      <div class="flex-shrink-0">
        <p-button
          label="Voltar"
          class="w-full md:w-auto"
          variant="outlined"
          styleClass="w-full md:w-auto"
          severity="secondary"
          (onClick)="onVoltar()"
        ></p-button>
      </div>

      <!-- botões Salvar Progresso + Adicionar/Atualizar -->
      <ng-container *ngIf="!isView">
        <div class="flex flex-row gap-2 flex-shrink-0">
          <p-button
            type="submit"
            class="flex-1 md:flex-none"
            label="Salvar Progresso"
            [disabled]="!(
              (form.get('nome')?.valid ||
              form.get('precoCusto')?.valid ||
              form.get('precoVenda')?.valid ||
              form.get('idMarca')?.valid ||
              form.get('idCategoria')?.valid) && form.invalid
            )"
          ></p-button>
          <p-button
            type="submit"
            class="flex-1 md:flex-none"
            [label]="isCreate ? 'Adicionar' : 'Atualizar'"
            [disabled]="form.invalid"
          ></p-button>
        </div>
      </ng-container>
    </div>
  </p-card>
</form>